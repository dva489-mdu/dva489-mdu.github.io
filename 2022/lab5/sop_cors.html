<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>DVA446</title>

    <!-- Bootstrap -->
    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/custom.css" rel="stylesheet">
    <link href="../css/print.css" rel="stylesheet" media="print">
    <link href="../css/prism.css" rel="stylesheet">


    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>

<body>

    <!-- Begin page content -->
    <div class="container">
        <div class="page-header nobreak">
            <h2>Excursion: Same-Origin Policy and Cross Origin Resource Sharing</h2>

            <p>
                In <a href="../lab3/my_first_social_media_app.html">My first social media app</a> we used a Heroku end-point to exfiltrate our information. In this exercise we will create a similar end-point, albeit somewhat more andvaced.
            </p>

            <p>
                The <a href="https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy">same-origin
                    policy</a> is an important security mechanism that restricts interaction between documents and scripts from different origins. Without the restrictions put in place by the SOP malicious code could easily forge any interaction with
                any logged in site. The restrictions of the SOP is the reason we could not simply use XHR to perform the
                <a href="../lab3/csrf.html">CSRF</a> attack. While important, the SOP gets in the way if we want to create an app that uses out-of-origin resource. An example of an interaction that would be stopped is XHR request to the Heroku end-point
                used in the <a href="../lab3/stored_xss.html">Stored XSS</a> attack.

            </p>

            <p>
                To allow the cross-domain request the Heroku app uses
                <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS">Cross-Origin Resource Sharing
                    (CORS)</a> to create an exemption to the otherwise strict SOP.
            </p>

            <p>
                In this exercise your task is to create a similar service, i.e., a service where you can POST information. To make the exercise a bit more interesting the idea is that we take the step over to a full <a href="https://www.ics.uci.edu/~fielding/pubs/dissertation/rest_arch_style.htm">RESTful</a>                service and use <a href="https://jwt.io/">JSON Web Tokens</a> (JWTs) for authentication. In particular read
                <a href="https://jwt.io/introduction/">Introduction to JSON Web Tokens</a> for an idea on how to use JWTs. The demands on the service are the following:
            </p>

            <ul>
                <li>The service should run over HTTPS</li>
                <li>The main page should allow a user to register a username.</li>
                <li>
                    On successful registration of a username a JWT should be generated and displayed to the user.
                </li>
                <li>
                    The JWT should grant GET and POST access to the service associated with the username the token was issued for.
                </li>
                <li>
                    A POST to /store/username should store the POST body given that a matching JWT was provided.
                </li>
                <li>
                    On a GET to /store/username should list all previously stored posts given that a matching JWT was provided.
                </li>

            </ul>


            <p>
                Follow the best practices suggested in <a href="https://cheatsheetseries.owasp.org/cheatsheets/REST_Security_Cheat_Sheet.html">REST Security
                    Cheat Sheet</a> and illustrate the use of your service by using it as the leak end-point in your unpatched version of
                <a href="../lab3/my_first_social_media_app.html">My first social media app</a>. To be able to to this you must use CORS to allow the cross-origin access of the service.
            </p>

            <h3>Excursion Result</h3>
            <p>
                Write a brief report describing how your service works, how your JWTs are set up, passed and verified. Also describe how the attack needs to be changed to use an authenticated end-point. Hand in the report together with the soruce code for the service.
            </p>

        </div>


</body>

</html>