<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>DVA489</title>

    <!-- Bootstrap -->
    <link href="../../css/bootstrap.min.css" rel="stylesheet">
    <link href="../../css/custom.css" rel="stylesheet">
    <link href="../../css/print.css" rel="stylesheet" media="print">


    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>

<body>

    <!-- Begin page content -->
    <div class="container">
        <div class="page-header nobreak">
            <h2>Attack: session hijacking</h2>

            <p>
                <a href="https://owasp.org/www-community/attacks/Session_Prediction">Session prediction</a> is a type of
                <a href="https://owasp.org/www-community/attacks/Session_hijacking_attackk">session hijacking attack</a>, that allows an attacker to get access to the application by guessing valid session information.
                <a href="my_first_authenticated_web_app.html#exercise2">My first authenticated web application</a> is particularly vulnerable to session hijacking since
            </p>

            <ul>
                <li>it uses a running session identifier easily obtainable from the pre-session information</li>
                <li>sessions never expire unless users actively log out</li>
            </ul>


            <h3>The attacks</h3>
            <p>
                Your first task is to perform a session hijacking attack on your web application. There are two ways to perform the attack.
            </p>

            <ol>
                <li>Simultanous login: clients that arrive at the same time to the login page obtain the same pre-session. Use this access the page from one browser without logging in on that browser. </li>
                <li>The pre-session gives away the next free sessions identifier. Use this as a starting point and search backwards for active sessions. You can inspect and set the cookie from the JavaScript console via <code>document.cookie</code> </li>
            </ol>


            <h3>Protecting the application</h3>

            <p>
                Your second task is to protect the web application from session hijacking via session prediction. You should deploy two countermeasures.
            </p>

            <ol>
                <li>To improve the quality of the session identifier it should be randomized. Follow the suggestions given by the OWASP cheat sheet on <a href="https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html#session-id-properties">session ID properties</a>.
                    You can use the node.js <a href="https://nodejs.org/api/crypto.html">crypto</a> library to generate the session identifier.
                </li>
                <li>
                    To reduce the attack window sessions should expire. Implement some kind of session expiration following the OWASP cheat sheet on <a href="https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html#session-expiration">session expiration</a>.
                    Server-side session expiration is the most important!
                </li>
            </ol>

            <h3>Attack report</h3>

            <p>
                Write a short attack report detailing the attack and your countermeasures.
            </p>

        </div>
    </div>

</body>

</html>